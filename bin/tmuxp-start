#!/bin/sh

if ! test -z "$1"; then
    selected="$1"
else
    selected=$(find $PERSONAL_PROJECTS -mindepth 1 -maxdepth 1 -type d | fzf)
    # selected=$(find $PERSONAL_PROJECTS $WORK_PROJECTS -mindepth 1 -maxdepth 1 -type d | fzf)
fi
if test -z "$selected" ; then
    exit 1
fi

selected_name=$(basename "$selected")
#selected_name=$(basename "$selected" | tr . _)

if test -f "$selected/$TMUX_TEMPLATE"; then
    PROJECT_NAME="$selected_name" \
    WORKSPACE="$selected" \
    tmuxp load \
        --yes \
        -f "$TMUX_CONFIG" \
        "$selected/$TMUX_TEMPLATE"
else
    echo "tmuxp session not found"
    exit 1
fi
